AGGREGATE UNTIL:
    We have received 500 messages
    OR
    1 minute has elapsed
    OR
    A message is received that has a property called "fireNow" and a value of "true"

THEN:
    Send to postProcessor
    
    
    ====
    
    You can use completionSize and completionInterval together and add a completionPredicate to the equation, like this (you do need to use eagerCheckCompletion="true" because we need to test the incoming message, not the aggregated message):

<route>
    <from uri="direct:aggregator" />
    <aggregate completionSize="500" completionInterval="60000" eagerCheckCompletion="true">
        <correlationExpression>
             <xpath>/fizz/buzz</xpath>
        </correlationExpression>
        <completion-predicate>
             <simple>${property.fireNow} == 'true'</simple>
        </completion-predicate>
        <to uri="bean:postProcessor?method=run" />
    </aggregate>
</route>


===
public class InvoiceTotalAggregator implements
AggregationStrategy {
public Exchange aggregate(Exchange oldExchange,
Exchange newExchange) {
if (oldExchange == null) {
return newExchange;
}
BigDecimal currentTotal =
oldExchange.getIn().getHeader("invoiceItemTotal",
BigDecimal.class);
BigDecimal itemTotal =
newExchange.getIn().getHeader("invoiceItemTotal",
BigDecimal.class);
oldExchange.getIn().setHeader("invoiceItemTotal",
currentTotal.add(itemTotal));
return oldExchange;
}
}

----